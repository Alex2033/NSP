<header class="header">
    <div class="header-top">

        <!-- logo -->
        <a [routerLink]="['']" class="logo-link" aria-label="logotype link">
            <svg class="logo" *ngIf="screen !== 'sm'">
                <use xlink:href="assets/sprites/icons.svg#logo"></use>
            </svg>
            <svg class="logo-mini"*ngIf="screen === 'sm'">
                <use xlink:href="assets/sprites/icons.svg#logo_mini"></use>
            </svg>
        </a>

        <!-- quote -->
        <div class="quote" *ngIf="screen !== 'sm' && quote">
            <blockquote class="quote-text">
                <p>
                    «{{ quote.text }}»
                </p>
                <a [routerLink]="['/persons', quote.author.id + '-' + quote.author.slug]" class="author" [innerHTML]="quote.author.firstName + '&nbsp;' + quote.author.lastName"></a>
            </blockquote>
            <div class="avatar">
              <app-responsive-image [xl]="quote.author.photoXl" [lg]="quote.author.photoLg" [md]="quote.author.photoMd" [xs]="quote.author.photoSm" [sm]="quote.author.photoSm"></app-responsive-image>
            </div>
        </div>

        <!-- mobile actions -->
        <button class="mobile-search-trigger" *ngIf="screen === 'sm'">
            <svg>
                <use xlink:href="assets/sprites/icons.svg#icon_search"></use>
            </svg>
        </button>
        <button class="menu-trigger" *ngIf="screen === 'sm'" (click)="showMenu()">
            <svg>
                <use xlink:href="assets/sprites/icons.svg#icon-menu"></use>
            </svg>
        </button>

    </div>

    <!-- header menu -->
    <div class="header-menu" [ngClass]="{'fixed': fixedMenu, 'under-banner': showBanner}" #menu>
        <div class="menu">
            <a href="#" aria-label="mini-logotype link">
                <svg class="logo-mini" *ngIf="fixedMenu">
                    <use xlink:href="assets/sprites/icons.svg#logo_mini"></use>
                </svg>
            </a>

            <!-- desktop navigation -->
            <nav class="navigation" [style.display]="screen === 'sm' ? 'none' : null" #navigationContainer>
                <ul class="navigation-list for-calculate" #tmpNavigationList style="flex-grow: 1;">
                    <li [class.highlight]="menuElement.highlight" *ngFor="let menuElement of menuElements">
                        <a [routerLink]="[menuElement.slug]">{{ menuElement.name }}</a>
                    </li>
                </ul>
                <ul class="navigation-list" #navigationList style="flex-grow: 1;">
                    <li [class.highlight]="menuElement.highlight" *ngFor="let menuElement of visibleMenuElements">
                        <a [routerLink]="[menuElement.slug]">{{ menuElement.name }}</a>
                    </li>
                </ul>
                <ul class="navigation-list" #moreButton [class.hidden]="hiddenMenuElements.length === 0 && visibleMenuElements.length > 0">
                    <li (clickOutside)="dropdownVisible = false"
                        [class.active]="dropdownVisible">
                        <button class="dropdown-btn" (click)="dropdownVisible = !dropdownVisible">
                            <span>Еще</span>
                            <svg [class.rotated]="dropdownVisible">
                                <use xlink:href="assets/sprites/icons.svg#chevron_down"></use>
                            </svg>
                        </button>
                        <div class="dropdown" [class.visible]="dropdownVisible">
                            <ul class="dropdown-list" #dropdownList (click)="dropdownVisible = !dropdownVisible">
                              <li [class.highlight]="menuElement.highlight" *ngFor="let menuElement of hiddenMenuElements">
                                <a [routerLink]="[menuElement.slug]">{{ menuElement.name }}</a>
                              </li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </nav>

            <!-- mobile navigation -->
            <div class="mobile-navigation" *ngIf="screen === 'sm'">
                <ng-scrollbar
                    class="horizontal-scrollbar"
                    track="horizontal"
                    #scrollbarRef
                >
                    <nav class="navigation">
                        <ul class="navigation-list" style="flex-grow: 1;" #widgetsContent>
                          <li [class.highlight]="menuElement.highlight" *ngFor="let menuElement of menuElements">
                            <a [routerLink]="[menuElement.slug]">{{ menuElement.name }}</a>
                          </li>
                        </ul>
                    </nav>

                </ng-scrollbar>
                <div class="gradient-control control-left" *ngIf="showLeftControl">
                    <div class="control-button small light" (click)="scrollbarRef.scrollTo({ left: (scrollPosition - 150) })">
                        <svg class="icon">
                            <use xlink:href="assets/sprites/icons.svg#chevron_left"></use>
                        </svg>
                    </div>
                </div>
                <div class="gradient-control control-right">
                    <div class="control-button small light" (click)="scrollbarRef.scrollTo({ left: (scrollPosition + 150) })">
                        <svg class="icon">
                            <use xlink:href="assets/sprites/icons.svg#chevron_right"></use>
                        </svg>
                    </div>
                </div>
            </div>

            <button type="button" class="search-button button scrolled-search-btn" *ngIf="fixedMenu">
                <svg class="icon">
                    <use xlink:href="assets/sprites/icons.svg#icon_search"></use>
                </svg>
            </button>
        </div>
    </div>

    <!-- header bottom -->
    <div class="header-bottom" *ngIf="screen !== 'sm'">
        <div class="header-actions">
            <div class="header-action">
                <svg>
                    <use xlink:href="assets/sprites/icons.svg#calendar"></use>
                </svg>
                <span class="header-action-text">
                  {{ now | date: 'd MMMM' }}, {{ now | date: 'shortTime' }}
                </span>
            </div>
            <div class="header-action">
                <svg>
                    <use xlink:href="assets/sprites/icons.svg#notification"></use>
                </svg>
                <button (click)="modal.open('subscription-form')" class="header-action-text">Подписаться</button>
            </div>
            <div class="header-action">
                <svg>
                    <use xlink:href="assets/sprites/icons.svg#mail"></use>
                </svg>
                <button (click)="modal.open('news-offer-form')" class="header-action-text">Прислать новость</button>
            </div>
        </div>
        <form class="search" (submit)="search()">
            <input [ngModelOptions]="{standalone: true}" type="text" placeholder="Поиск по сайту" [(ngModel)]="searchQuery" required>
            <button type="submit" class="search-button short-button no-bg">
                <svg class="icon">
                    <use xlink:href="assets/sprites/icons.svg#icon_search"></use>
                </svg>
            </button>
        </form>
    </div>
</header>
